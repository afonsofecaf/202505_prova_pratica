<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Prova Prática – Procedure e Trigger no Supabase (Versão Avançada)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container my-5">

  <h1 class="text-primary">Link de Acesso: https://afonsofecaf.github.io/202505_prova_pratica</h1>

  <h1 class="text-primary">🧪 Prova Prática – Procedure e Trigger no Supabase (Versão Avançada)</h1>

  <h2 class="text-secondary mt-4">📌 Situação:</h2>
  <p>
    Você foi contratado para modelar parte do sistema de gestão de uma instituição de ensino. Seu desafio será criar três tabelas interligadas e configurar a lógica de negócio de forma automatizada com o uso de <strong>function</strong> e <strong>trigger</strong>.
  </p>

  <h2 class="text-secondary mt-4">🎯 Objetivo:</h2>
  <p>
    Sempre que um novo aluno for matriculado em um curso, o sistema deverá:
  </p>
  <ul>
    <li>Registrar a matrícula em uma tabela intermediária.</li>
    <li>Gerar automaticamente um <strong>log</strong> dessa matrícula.</li>
    <li>Atualizar a quantidade total de alunos matriculados no respectivo curso.</li>
  </ul>

  <h2 class="text-secondary mt-4">📁 Estrutura de dados obrigatória:</h2>
  <p>Você deverá criar e utilizar as seguintes tabelas:</p>

  <ul>
    <li><strong>aluno</strong>: deve conter pelo menos os campos <code>id</code>, <code>nome</code> e <code>email</code>.</li>
    <li><strong>curso</strong>: deve conter pelo menos os campos <code>id</code>, <code>nome</code> e <code>qtd_matriculados</code>.</li>
    <li><strong>matricula</strong>: deve conter pelo menos os campos <code>id</code>, <code>aluno_id</code> e <code>curso_id</code>.</li>
    <li><strong>logs_matricula</strong>: deve conter pelo menos os campos <code>id</code>, <code>aluno_id</code>, <code>curso_id</code> e <code>data_matricula</code>.</li>
  </ul>

  <h2 class="text-secondary mt-4">✅ O que deve ser entregue:</h2>
  <ol>
    <li>Criação das quatro tabelas acima.</li>
    <li>Criação de uma <strong>function</strong> ou <strong>procedure</strong> que:
      <ul>
        <li>Adicione um registro na tabela de <code>logs_matricula</code> automaticamente ao ocorrer uma nova matrícula.</li>
        <li>Atualize o campo <code>qtd_matriculados</code> na tabela <code>curso</code>, somando 1 a cada nova matrícula.</li>
      </ul>
    </li>
    <li>Criação de uma <strong>trigger</strong> que acione essa function após a inserção na tabela <code>matricula</code>.</li>
    <li>Comandos de inserção para simular a matrícula de pelo menos um aluno em um curso.</li>
  </ol>

  <h2 class="text-secondary mt-4">📝 Regras obrigatórias:</h2>
  <ul>
    <li>A trigger deve ser configurada para ser executada <strong>automaticamente após o INSERT</strong> na tabela de matrícula.</li>
    <li>A function deve conter as duas operações exigidas: geração do log + atualização da contagem de alunos.</li>
    <li>Os comandos devem ser organizados na ordem correta para execução direta no Supabase.</li>
    <li><strong>Não envie um arquivo</strong> — o código SQL deve ser colado diretamente no formulário de envio.</li>
  </ul>

  <h2 class="text-secondary mt-4">📤 Envio:</h2>
  <p>Copie todo o seu código SQL (com <code>CREATE TABLE</code>, <code>CREATE FUNCTION</code>, <code>CREATE TRIGGER</code> e <code>INSERTS</code> de teste) e cole no formulário disponível abaixo:</p>

  <a class="btn btn-danger btn-lg w-100 mt-4" href="https://docs.google.com/forms/d/e/1FAIpQLSd_HW0MH8Y-EGSo5DzlBc7z2hqCDQLgbe4XE5CTpeud_VGKFQ/viewform?usp=dialog" target="_blank">
    🚀 Enviar código via Formulário Google
  </a>

</body>
</html>
